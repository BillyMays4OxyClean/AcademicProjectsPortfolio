function [ATMOm,ATMOe] = StandardATM(alt,range)
    %U.S. Standard Atmosphere Model
    %Justin Rhine
    %
    %http://www.braeunig.us/space/atmmodel.htm
    %
    %Above 86km things are calculated using the websites lower acurate method.
    %For our project it may not adversely affect too many calculations with the inaccuracy.
    %
    %Adapted for use as a function file by Luke Patterson
    %Outputs are: Altitude, Temperature, Pressure, Density, Speed of Sound
    %_________________________________________

    alt = floor(alt);


    R=287.053;
    SH=1.4;


    for i= 1:1:alt

        hm(i,1) = i;

        if i/1000 < 11
            %Metric
            T(i,1)=288.15-6.5*(i/1000);%Degrees - K
            P(i,1)=101325.0*(288.15/T(i))^(34.1632/-6.5); %Pascals
            d(i,1)=P(i)/(R*T(i)); %Kg/m^3
            a(i,1)=sqrt(SH*R*T(i)); %m/s

        elseif i/1000 < 20

            %Metric
            T(i,1) = 216.65; %Degrees - K
            P(i,1) = 22632.06*exp(-34.1632*((i/1000)-11)/216.65); %Pascals
            d(i,1) = P(i)/(R*T(i));
            a(i,1) = sqrt(SH*R*T(i));

        elseif i/1000 < 32

            %Metric
            T(i,1) = 196.65+i/1000; %Degrees - K
            P(i,1) = 5474.889*(216.65/(216.65+(i/1000-20)))^34.1632; %Pascals
            d(i,1) = P(i)/(R*T(i)); %Kg/m^3
            a(i,1) = sqrt(SH*R*T(i)); %m/s

        elseif i/1000 < 47

            %Metric
            T(i,1) = 139.05+2.8*i/1000;
            P(i,1) = 868.0187*(228.65/(228.65+2.8*(i/1000-32)))^(34.1632/2.8);
            d(i,1) = P(i)/(R*T(i));        
            a(i,1) = sqrt(SH*R*T(i));

        elseif i/1000 < 51
            %Metric
            T(i,1) = 270.65;
            P(i,1) = 110.9063*exp(-34.1632*(i/1000-47)/270.65);
            d(i,1) = P(i)/(R*T(i));
            a(i,1) = sqrt(SH*R*T(i));

        elseif i/1000 < 71
            %Metric
            T(i,1) = 413.45-2.8*(i/1000);
            P(i,1) = 66.93887*(270.65/(270.65-2.8*(i/1000-51)))^(34.1632/-2.8);
            d(i,1) = P(i)/(R*T(i));
            a(i,1) = sqrt(SH*R*T(i));

        elseif i/1000 < 86
            %Metric
            T(i,1) = 356.65-2.0*(i/1000);
            P(i,1) = 3.956420*(214.65/(214.65-2.0*(i/1000-71)))^(34.1632/-2.0);
            d(i,1) = P(i)/(R*T(i));
            a(i,1) = sqrt(SH*R*T(i));

        elseif i/1000 < 91 
            %Metric
            T(i,1) = 186.8673;
            P(i,1) = exp(0.000000*(i/1000)^4+	2.159582E-06*(i/1000)^3-4.836957E-04*(i/1000)^2-0.1425192*(i/1000)+13.47530);
            d(i,1) = exp(0.000000*(i/1000)^4-3.322622E-06*(i/1000)^3+9.111460E-04*(i/1000)^2-0.2609971*(i/1000)+5.944694);
            a(i,1) = sqrt(SH*R*T(i));

        elseif i/1000 < 100 
            %Metric
            T(i,1) = 263.1905-76.3232*sqrt(1-((i/1000-91) / -19.9429)^2);
            P(i,1) = exp(0.000000*(i/1000)^4+3.304895E-05*(i/1000)^3-0.009062730*(i/1000)^2+0.6516698*(i/1000)-11.03037);
            d(i,1) = exp(0.000000*(i/1000)^4+2.873405E-05*(i/1000)^3-0.008492037*(i/1000)^2+0.6541179*(i/1000)-23.62010);
            a(i,1) = sqrt(SH*R*T(i));    

        elseif i/1000 < 110
            %Metric
            T(i,1) = 263.1905-76.3232*sqrt(1-((i/1000-91) / -19.9429)^2);
            P(i,1) = exp(0.000000*(i/1000)^4+6.693926E-05*(i/1000)^3-0.01945388*(i/1000)^2+1.719080*(i/1000)-47.75030);
            d(i,1) = exp(-1.240774E-05*(i/1000)^4+0.005162063*(i/1000)^3-0.8048342*(i/1000)^2+55.55996*(i/1000)-1443.338);
            a(i,1) = sqrt(SH*R*T(i));

        elseif i/1000 <= 120
            %Metric
            T(i,1) = 240 + 12 * (i/1000 - 110);
            P(i,1) = exp(0.000000*(i/1000)^4-6.539316E-05*(i/1000)^3+0.02485568*(i/1000)^2-3.223620*(i/1000)+135.9355);
            d(i,1) = exp(0.00000*(i/1000)^4-8.854164E-05*(i/1000)^3+0.03373254*(i/1000)^2-4.390837*(i/1000)+176.5294);
            a(i,1) = sqrt(SH*R*T(i));
        end
    end

    alte=round(alt/0.3048,0)-1;

    for i= 1:1:alte

        he(i,1)=i;

        if i*0.3048/1000 < 11
            %Metric
            Tm(i,1)=288.15-6.5*(i*0.3048/1000);%Degrees - K
            Pm(i,1)=101325.0*(288.15/Tm(i))^(34.1632/-6.5); %Pascals
            dm(i,1)=Pm(i)/(R*Tm(i)); %Kg/m^3
            am(i,1)=sqrt(SH*R*Tm(i)); %m/s

            %English
            Te(i,1) = (Tm(i,1)-273.15)*9/5+32; %degrees - F
            Pe(i,1) = Pm(i,1)*0.0208854342332; %lbf/ft^2
            de(i,1) = dm(i,1)*0.062428; %lb/ft^3
            ae(i,1) = am(i,1)*3.28084; %ft/s


        elseif i*0.3048/1000 < 20
            %Metric
            Tm(i,1) = 216.65; %Degrees - K
            Pm(i,1) = 22632.06*exp(-34.1632*((i*0.3048/1000)-11)/216.65); %Pascals
            dm(i,1) = Pm(i)/(R*Tm(i));
            am(i,1) = sqrt(SH*R*Tm(i));

            %English
            Te(i,1) = (Tm(i,1)-273.15)*9/5+32; %degrees - F
            Pe(i,1) = Pm(i,1)*0.0208854342332; %lbf/ft^2
            de(i,1) = dm(i,1)*0.062428; %lb/ft^3
            ae(i,1) = am(i,1)*3.28084; %ft/s

        elseif i*0.3048/1000 < 32

            %Metric
            Tm(i,1) = 196.65+i*0.3048/1000; %Degrees - K
            Pm(i,1) = 5474.889*(216.65/(216.65+(i*0.3048/1000-20)))^34.1632; %Pascals
            dm(i,1) = Pm(i)/(R*Tm(i)); %Kg/m^3
            am(i,1) = sqrt(SH*R*Tm(i)); %m/s

            %English
            Te(i,1) = (Tm(i,1)-273.15)*9/5+32; %degrees - F
            Pe(i,1) = Pm(i,1)*0.0208854342332; %lbf/ft^2
            de(i,1) = dm(i,1)*0.062428; %lb/ft^3
            ae(i,1) = am(i,1)*3.28084; %ft/s

        elseif i*0.3048/1000 < 47

            %Metric
            Tm(i,1) = 139.05+2.8*i*0.3048/1000;
            Pm(i,1) = 868.0187*(228.65/(228.65+2.8*(i*0.3048/1000-32)))^(34.1632/2.8);
            dm(i,1) = Pm(i)/(R*Tm(i));        
            am(i,1) = sqrt(SH*R*Tm(i));

            %English
            Te(i,1) = (Tm(i,1)-273.15)*9/5+32; %degrees - F
            Pe(i,1) = Pm(i,1)*0.0208854342332; %lbf/ft^2
            de(i,1) = dm(i,1)*0.062428; %lb/ft^3
            ae(i,1) = am(i,1)*3.28084; %ft/s

        elseif i*0.3048/1000 < 51
            %Metric
            Tm(i,1) = 270.65;
            Pm(i,1) = 110.9063*exp(-34.1632*(i*0.3048/1000-47)/270.65);
            dm(i,1) = Pm(i)/(R*Tm(i));
            am(i,1) = sqrt(SH*R*Tm(i));

            %English
            Te(i,1) = (Tm(i,1)-273.15)*9/5+32; %degrees - F
            Pe(i,1) = Pm(i,1)*0.0208854342332; %lbf/ft^2
            de(i,1) = dm(i,1)*0.062428; %lb/ft^3
            ae(i,1) = am(i,1)*3.28084; %ft/s

        elseif i*0.3048/1000 < 71
            %Metric
            Tm(i,1) = 413.45-2.8*(i*0.3048/1000);
            Pm(i,1) = 66.93887*(270.65/(270.65-2.8*(i*0.3048/1000-51)))^(34.1632/-2.8);
            dm(i,1) = Pm(i)/(R*Tm(i));
            am(i,1) = sqrt(SH*R*Tm(i));

            %English
            Te(i,1) = (Tm(i,1)-273.15)*9/5+32; %degrees - F
            Pe(i,1) = Pm(i,1)*0.0208854342332; %lbf/ft^2
            de(i,1) = dm(i,1)*0.062428; %lb/ft^3
            ae(i,1) = am(i,1)*3.28084; %ft/s

        elseif i*0.3048/1000 < 86
            %Metric
            Tm(i,1) = 356.65-2.0*(i*0.3048/1000);
            Pm(i,1) = 3.956420*(214.65/(214.65-2.0*(i*0.3048/1000-71)))^(34.1632/-2.0);
            dm(i,1) = Pm(i)/(R*Tm(i));
            am(i,1) = sqrt(SH*R*Tm(i));

            %English
            Te(i,1) = (Tm(i,1)-273.15)*9/5+32; %degrees - F
            Pe(i,1) = Pm(i,1)*0.0208854342332; %lbf/ft^2
            de(i,1) = dm(i,1)*0.062428; %lb/ft^3
            ae(i,1) = am(i,1)*3.28084; %ft/s

        elseif i*0.3048/1000 < 91 
            %Metric
            Tm(i,1) = 186.8673;
            Pm(i,1) = exp(0.000000*(i*0.3048/1000)^4+2.159582E-06*(i*0.3048/1000)^3-4.836957E-04*(i*0.3048/1000)^2-0.1425192*(i*0.3048/1000)+13.47530);
            dm(i,1) = exp(0.000000*(i*0.3048/1000)^4-3.322622E-06*(i*0.3048/1000)^3+9.111460E-04*(i*0.3048/1000)^2-0.2609971*(i*0.3048/1000)+5.944694);
            am(i,1) = sqrt(SH*R*Tm(i));

            %English
            Te(i,1) = (Tm(i,1)-273.15)*9/5+32; %degrees - F
            Pe(i,1) = Pm(i,1)*0.0208854342332; %lbf/ft^2
            de(i,1) = dm(i,1)*0.062428; %lb/ft^3
            ae(i,1) = am(i,1)*3.28084; %ft/s

        elseif i*0.3048/1000 < 100 
            %Metric
            Tm(i,1) = 263.1905-76.3232*sqrt(1-((i*0.3048/1000-91) / -19.9429)^2);
            Pm(i,1) = exp(0.000000*(i*0.3048/1000)^4+3.304895E-05*(i*0.3048/1000)^3-0.009062730*(i*0.3048/1000)^2+0.6516698*(i*0.3048/1000)-11.03037);
            dm(i,1) = exp(0.000000*(i*0.3048/1000)^4+2.873405E-05*(i*0.3048/1000)^3-0.008492037*(i*0.3048/1000)^2+0.6541179*(i*0.3048/1000)-23.62010);
            am(i,1) = sqrt(SH*R*Tm(i));    

            %English
            Te(i,1) = (Tm(i,1)-273.15)*9/5+32; %degrees - F
            Pe(i,1) = Pm(i,1)*0.0208854342332; %lbf/ft^2
            de(i,1) = dm(i,1)*0.062428; %lb/ft^3
            ae(i,1) = am(i,1)*3.28084; %ft/s

        elseif i*0.3048/1000 < 110
            %Metric
            Tm(i,1) = 263.1905-76.3232*sqrt(1-((i*0.3048/1000-91) / -19.9429)^2);
            Pm(i,1) = exp(0.000000*(i*0.3048/1000)^4+6.693926E-05*(i*0.3048/1000)^3-0.01945388*(i*0.3048/1000)^2+1.719080*(i*0.3048/1000)-47.75030);
            dm(i,1) = exp(-1.240774E-05*(i*0.3048/1000)^4+0.005162063*(i*0.3048/1000)^3-0.8048342*(i*0.3048/1000)^2+55.55996*(i*0.3048/1000)-1443.338);
            am(i,1) = sqrt(SH*R*Tm(i));

            %English
            Te(i,1) = (Tm(i,1)-273.15)*9/5+32; %degrees - F
            Pe(i,1) = Pm(i,1)*0.0208854342332; %lbf/ft^2
            de(i,1) = dm(i,1)*0.062428; %lb/ft^3
            ae(i,1) = am(i,1)*3.28084; %ft/s

        elseif i*0.3048/1000 <= 120
            %Metric
            Tm(i,1) = 240 + 12 * (i*0.3048/1000 - 110);
            Pm(i,1) = exp(0.000000*(i*0.3048/1000)^4-6.539316E-05*(i*0.3048/1000)^3+0.02485568*(i*0.3048/1000)^2-3.223620*(i*0.3048/1000)+135.9355);
            dm(i,1) = exp(0.000000*(i*0.3048/1000)^4-8.854164E-05*(i*0.3048/1000)^3+0.03373254*(i*0.3048/1000)^2-4.390837*(i*0.3048/1000)+176.5294);
            am(i,1) = sqrt(SH*R*Tm(i));

            %English
            Te(i,1) = (Tm(i,1)-273.15)*9/5+32; %degrees - F
            Pe(i,1) = Pm(i,1)*0.0208854342332; %lbf/ft^2
            de(i,1) = dm(i,1)*0.062428; %lb/ft^3
            ae(i,1) = am(i,1)*3.28084; %ft/s

        end
    end
    
    if nargin == 1
        ATMOm = [hm(alt,1) T(alt,1) P(alt,1) d(alt,1) a(alt,1)]; %Metric Table
        ATMOe = [he(alte,1) Te(alte,1) Pe(alte,1) de(alte,1) ae(alte,1)]; %English Table
    elseif nargin == 2
        ATMOm = [hm T P d a]; %Metric Table
        ATMOe = [he Te Pe de ae]; %English Table
    end
end

